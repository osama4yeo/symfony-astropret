{# templates/home.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Accueil - Astropret{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .gallery-item .card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .gallery-item .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;
        }
        .gallery-img { /* Style pour les images dans la grille */
            width: 100%;
            height: 200px; 
            object-fit: cover; 
        }
        .card-title-gallery {
            min-height: 3.5rem; 
        }
        .card-text-gallery {
            font-size: 0.9em;
            color: #6c757d;
        }

        /* Style pour le bouton d'administration de la galerie */
        .admin-gallery-manage-button {
            position: fixed; /* ou absolute si vous avez un conteneur relatif */
            top: 80px; /* Ajustez selon la hauteur de votre navbar */
            left: 20px;
            z-index: 1030; /* S'assurer qu'il est au-dessus d'autres éléments */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
    </style>
{% endblock %}

{% block body_content %}
    {# Bouton pour l'admin pour gérer la galerie #}
    {% if is_granted('ROLE_ADMIN') %}
        <a href="{{ path('admin_gallery_index') }}" class="btn btn-warning admin-gallery-manage-button" title="Gérer la galerie d'images">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-images" viewBox="0 0 16 16" style="vertical-align: text-bottom;">
              <path d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/>
              <path d="M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2zM14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1zM2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1h-10z"/>
            </svg>
            Gérer Galerie
        </a>
    {% endif %}

    <div class="container mt-4">
        <div class="text-center mb-5">
            <h1 class="display-4">Galerie Astronomique</h1>
            <p class="lead">Découvrez la beauté de l'univers à travers notre sélection d'images.</p>
        </div>

        {# Utilisation de la variable gallery_items_data passée par HomeController #}
        {% if gallery_items_data is not empty %}
            <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
                {% for item in gallery_items_data %} {# Changement de nom de variable de boucle #}
                    <div class="col gallery-item d-flex align-items-stretch"> {# Ajout d-flex align-items-stretch #}
                        <div class="card h-100 shadow-sm w-100"> {# Ajout w-100 et h-100 ici aussi #}
                            <a href="{{ asset('images/gallery/' ~ item.imageFilename) }}" 
                               data-lightbox="astro-gallery" 
                               data-title="{{ item.titre ~ (item.description ? ' - ' ~ item.description : '') }}">
                                <img src="{{ asset('images/gallery/' ~ item.imageFilename) }}" class="card-img-top gallery-img" alt="{{ item.titre }}">
                            </a>
                            <div class="card-body d-flex flex-column"> {# d-flex flex-column pour pousser la description/date en bas si besoin #}
                                <h5 class="card-title card-title-gallery">{{ item.titre }}</h5>
                                {% if item.description %}
                                    <p class="card-text card-text-gallery">{{ item.description }}</p>
                                {% endif %}
                                <p class="card-text small text-muted mt-auto"> {# mt-auto pour pousser en bas #}
                                    <small>Publié le : {{ item.updatedAt|date('d/m/Y') }}</small>
                                </p>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-center">Aucune image à afficher dans la galerie pour le moment.</p>
        {% endif %}
    </div>
{% endblock body_content %}

{% block javascripts_page_specific %}
    {{ parent() }}
    {# Lightbox2 s'initialise automatiquement #}
{% endblock %}